"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var PopulableItem = (function () {
    function PopulableItem(val) {
        this.val = val;
        this.populated = (typeof val !== "string");
        //  this.addProperties();
    }
    PopulableItem.prototype.addProperties = function () {
        if (this.populated) {
            var df = this.val.datafields;
            var _loop_1 = function (i, n) {
                var key = df[i];
                Object.defineProperty(this_1, key, {
                    get: function () { return this.val[key]; },
                    set: function (value) { this.val[key] = value; }
                });
            };
            var this_1 = this;
            for (var i = 0, n = df.length; i < n; ++i) {
                _loop_1(i, n);
            }
        }
    };
    PopulableItem.prototype.getObjectId = function () {
        //Assert.exists(this.val);
        if (!this.val)
            return null;
        if (this.val._id)
            return this.val._id;
        else
            return this.val;
    };
    PopulableItem.prototype.getObject = function () {
        if (this.val._id)
            return this.val;
        else
            return {}; //<ObjectId>this.item;
    };
    PopulableItem.prototype.isPopulated = function () {
        return this.isPopulated;
    };
    PopulableItem.prototype.set = function (v) {
        this.val = v;
        this.populated = (typeof v !== "string");
        //  this.addProperties();
    };
    PopulableItem.prototype.toString = function () {
        return this.getObjectId();
    };
    return PopulableItem;
}());
exports.PopulableItem = PopulableItem;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJmYWNlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVyZmFjZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUF5Q0M7SUFHSSx1QkFBbUIsR0FBaUI7UUFBakIsUUFBRyxHQUFILEdBQUcsQ0FBYztRQUNoQyxJQUFJLENBQUMsU0FBUyxHQUFHLENBQUMsT0FBTyxHQUFHLEtBQUssUUFBUSxDQUFDLENBQUM7UUFDNUMseUJBQXlCO0lBQzVCLENBQUM7SUFDRCxxQ0FBYSxHQUFiO1FBQ0ksRUFBRSxDQUFBLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFBLENBQUM7WUFDZixJQUFJLEVBQUUsR0FBSyxJQUFJLENBQUMsR0FBSSxDQUFDLFVBQVUsQ0FBQztvQ0FDeEIsQ0FBQyxFQUFJLENBQUM7Z0JBQ1YsSUFBSSxHQUFHLEdBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN2QixNQUFNLENBQUMsY0FBYyxTQUFPLEdBQUcsRUFBRTtvQkFDN0IsR0FBRyxFQUFFLGNBQVksTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUN4QyxHQUFHLEVBQUUsVUFBUyxLQUFLLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDO2lCQUNsRCxDQUFDLENBQUM7WUFDUCxDQUFDOztZQU5BLEdBQUcsQ0FBQSxDQUFDLElBQUksQ0FBQyxHQUFDLENBQUMsRUFBRSxDQUFDLEdBQUUsRUFBRSxDQUFDLE1BQU0sRUFBRyxDQUFDLEdBQUcsQ0FBQyxFQUFHLEVBQUUsQ0FBQzt3QkFBL0IsQ0FBQyxFQUFJLENBQUM7YUFNZDtRQUNKLENBQUM7SUFFTCxDQUFDO0lBQ0QsbUNBQVcsR0FBWDtRQUNJLDBCQUEwQjtRQUMxQixFQUFFLENBQUEsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7WUFBQyxNQUFNLENBQUMsSUFBSSxDQUFDO1FBQzFCLEVBQUUsQ0FBQyxDQUFLLElBQUksQ0FBQyxHQUFJLENBQUMsR0FBRyxDQUFDO1lBQUMsTUFBTSxDQUFLLElBQUksQ0FBQyxHQUFJLENBQUMsR0FBRyxDQUFDO1FBQ2hELElBQUk7WUFBQyxNQUFNLENBQVcsSUFBSSxDQUFDLEdBQUcsQ0FBQztJQUVuQyxDQUFDO0lBQ0QsaUNBQVMsR0FBVDtRQUNJLEVBQUUsQ0FBQyxDQUFLLElBQUksQ0FBQyxHQUFJLENBQUMsR0FBRyxDQUFDO1lBQUMsTUFBTSxDQUFJLElBQUksQ0FBQyxHQUFHLENBQUM7UUFDMUMsSUFBSTtZQUFDLE1BQU0sQ0FBSSxFQUFFLENBQUMsQ0FBQSxzQkFBc0I7SUFDNUMsQ0FBQztJQUNELG1DQUFXLEdBQVg7UUFDSSxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQztJQUM1QixDQUFDO0lBQ0QsMkJBQUcsR0FBSCxVQUFJLENBQWU7UUFDZixJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztRQUNiLElBQUksQ0FBQyxTQUFTLEdBQUcsQ0FBQyxPQUFPLENBQUMsS0FBSyxRQUFRLENBQUMsQ0FBQztRQUMxQyx5QkFBeUI7SUFDNUIsQ0FBQztJQUNELGdDQUFRLEdBQVI7UUFDSSxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQzlCLENBQUM7SUFDTCxvQkFBQztBQUFELENBQUMsQUExQ0QsSUEwQ0M7QUExQ1ksc0NBQWEiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IHtBc3NlcnR9IGZyb20gXCIuLi91dGlscy91dGlsc1wiXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERhdGFJbnRlcmZhY2V7XHJcbiAgICBzYXZlPFQ+KG9iajpNb2RlbCxmOkZ1bmN0aW9uKTtcclxuICAgIHNlcmlhbGl6ZShvYmo6TW9kZWwpOnN0cmluZztcclxuICAgIHNlcmlhbGl6ZU1vZGlmaWVkKG9iajpNb2RlbCxyZWZlcmVuY2VSYXc6IFJhdyk6c3RyaW5nO1xyXG4gICAgZ2V0UG9wdWxhdGVkSXRlbShvYmo6TW9kZWwsa2V5OnN0cmluZyk6UG9wdWxhYmxlSXRlbTxhbnk+O1xyXG4gICAgZ2V0UG9wdWxhdGVkQXJyYXkob2JqOk1vZGVsLGtleTpzdHJpbmcpOlBvcHVsYWJsZUl0ZW08YW55PltdO1xyXG4gICAgZ2V0RmllbGQob2JqOk1vZGVsLGZpZWxkTmFtZTogc3RyaW5nKSA7XHJcbiAgICBnZXRGaWVsZHMob2JqOk1vZGVsLHVzZUV4dHJhPzogYm9vbGVhbik6IFJhdyA7XHJcbiAgICBpc0ZpZWxkTW9kaWZpZWQob2JqOk1vZGVsLG9sZDogYW55LCBuZXU6IGFueSk6IGJvb2xlYW4gO1xyXG4gICAgaXNNb2RpZmllZChvYmo6TW9kZWwsZmllbGROYW1lOiBzdHJpbmcsIHJlZjogUmF3LCBjdXI6IGFueSk6IGJvb2xlYW47XHJcbiAgICBnZXRNb2RpZmllZEZpZWxkcyhvYmo6TW9kZWwscmVmOiBSYXcpOiBSYXcgO1xyXG4gICAgY3J5cHQocGFzc3dvcmQ6c3RyaW5nKTtcclxufVxyXG5cclxuIGV4cG9ydCB0eXBlIExvZ2luQ2hhbmdlZEludGVyZmFjZSA9eyAgICBhdXRoZW50aWZpY2F0ZWQ6Ym9vbGVhbiwgICBpc1RvdXJEb25lOmJvb2xlYW59O1xyXG4gXHJcbiBleHBvcnQgaW50ZXJmYWNlIFByaWNle1xyXG4gICAgIHZhbHVlOm51bWJlcjtcclxuICAgICBjdXJyZW5jeUNvZGU6c3RyaW5nO1xyXG4gfVxyXG4gZXhwb3J0IGludGVyZmFjZSBSZWN1cnJlbnRQYXltZW50e1xyXG4gICAgIG5hbWU6c3RyaW5nO1xyXG4gICAgIHByaWNlOlByaWNlO1xyXG4gICAgIGZyZXF1ZW5jeTpzdHJpbmc7XHJcblxyXG4gfVxyXG4gXHJcbiBleHBvcnQgaW50ZXJmYWNlIE1vZGVsSW50ZXJmYWNlIHtcclxuICAgICBfaWQ6IE9iamVjdElkO1xyXG4gICAgIGRhdGFmaWVsZHM6IHN0cmluZ1tdO1xyXG4gICAgIHNhdmU8VD4oZjpGdW5jdGlvbik7XHJcbiAgICAgc2VyaWFsaXplKCk6c3RyaW5nO1xyXG4gICAgIHNlcmlhbGl6ZU1vZGlmaWVkKHJlZmVyZW5jZVJhdzogUmF3KTpzdHJpbmc7XHJcbiB9XHJcbiBpbnRlcmZhY2UgTW9kZWwge1xyXG4gICAgIF9pZDogT2JqZWN0SWQ7XHJcbiAgICAgZGF0YWZpZWxkczogc3RyaW5nW107XHJcbiB9XHJcbiBleHBvcnQgY2xhc3MgUG9wdWxhYmxlSXRlbTxUIGV4dGVuZHMgTW9kZWw+IHtcclxuXHJcbiAgICAgcG9wdWxhdGVkOiBib29sZWFuO1xyXG4gICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB2YWw6IE9iamVjdElkIHwgVCkge1xyXG4gICAgICAgICB0aGlzLnBvcHVsYXRlZCA9ICh0eXBlb2YgdmFsICE9PSBcInN0cmluZ1wiKTtcclxuICAgICAgICAvLyAgdGhpcy5hZGRQcm9wZXJ0aWVzKCk7XHJcbiAgICAgfVxyXG4gICAgIGFkZFByb3BlcnRpZXMoKXtcclxuICAgICAgICAgaWYodGhpcy5wb3B1bGF0ZWQpe1xyXG4gICAgICAgICAgICAgbGV0IGRmPSg8VD50aGlzLnZhbCkuZGF0YWZpZWxkcztcclxuICAgICAgICAgICAgIGZvcihsZXQgaT0wLCBuPSBkZi5sZW5ndGggOyBpIDwgbiA7ICsraSl7XHJcbiAgICAgICAgICAgICAgICAgbGV0IGtleTpzdHJpbmc9IGRmW2ldO1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGtleSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7cmV0dXJuIHRoaXMudmFsW2tleV07IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgeyB0aGlzLnZhbFtrZXldID0gdmFsdWU7IH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgfVxyXG4gICAgIGdldE9iamVjdElkKCk6IE9iamVjdElkIHtcclxuICAgICAgICAgLy9Bc3NlcnQuZXhpc3RzKHRoaXMudmFsKTtcclxuICAgICAgICAgaWYoIXRoaXMudmFsKSByZXR1cm4gbnVsbDtcclxuICAgICAgICAgaWYgKCg8VD50aGlzLnZhbCkuX2lkKSByZXR1cm4gKDxUPnRoaXMudmFsKS5faWQ7XHJcbiAgICAgICAgIGVsc2UgcmV0dXJuIDxPYmplY3RJZD50aGlzLnZhbDtcclxuXHJcbiAgICAgfVxyXG4gICAgIGdldE9iamVjdCgpOiBUIHtcclxuICAgICAgICAgaWYgKCg8VD50aGlzLnZhbCkuX2lkKSByZXR1cm4gPFQ+dGhpcy52YWw7XHJcbiAgICAgICAgIGVsc2UgcmV0dXJuIDxUPnt9Oy8vPE9iamVjdElkPnRoaXMuaXRlbTtcclxuICAgICB9XHJcbiAgICAgaXNQb3B1bGF0ZWQoKSB7XHJcbiAgICAgICAgIHJldHVybiB0aGlzLmlzUG9wdWxhdGVkO1xyXG4gICAgIH1cclxuICAgICBzZXQodjogT2JqZWN0SWQgfCBUKSB7XHJcbiAgICAgICAgIHRoaXMudmFsID0gdjtcclxuICAgICAgICAgdGhpcy5wb3B1bGF0ZWQgPSAodHlwZW9mIHYgIT09IFwic3RyaW5nXCIpO1xyXG4gICAgICAgIC8vICB0aGlzLmFkZFByb3BlcnRpZXMoKTtcclxuICAgICB9XHJcbiAgICAgdG9TdHJpbmcoKTpzdHJpbmd7IFxyXG4gICAgICAgICByZXR1cm4gdGhpcy5nZXRPYmplY3RJZCgpO1xyXG4gICAgIH1cclxuIH1cclxuIFxyXG4gZXhwb3J0IHR5cGUgUG9wSXRlbTxUIGV4dGVuZHMgTW9kZWw+ID0gT2JqZWN0SWQgfCBUO1xyXG5cclxuIGV4cG9ydCB0eXBlIFF1ZXJ5UG9wdWxhdGVPcHRpb249e21vZGVsPzphbnkscG9wdWxhdGU/OmFueSxwYXRoPzphbnksc2VsZWN0PzphbnksbWF0Y2g/OmFueX07XHJcbiBleHBvcnQgdHlwZSBRdWVyeVNlbGVjdE9wdGlvbj1hbnk7XHJcbiBleHBvcnQgdHlwZSBRdWVyeVNvcnRPcHRpb249YW55O1xyXG4gZXhwb3J0IHR5cGUgUXVlcnlMaW1pdE9wdGlvbj1hbnk7XHJcbiBleHBvcnQgdHlwZSBRdWVyeVNraXBPcHRpb249YW55O1xyXG4gZXhwb3J0IHR5cGUgUXVlcnlNYXRjaE9wdGlvbj1hbnk7XHJcbiBcclxuIFxyXG4vLyBleHBvcnQgdHlwZSBTdGVwID0geyBjb2RlOiBTdGVwQ29kZSwgbmFtZTogc3RyaW5nLCB0b2RlZmluZTogUG9wSXRlbTxDb250YWN0PltdLCBxdWFsaWZpZWQ6IFBvcEl0ZW08Q29udGFjdD5bXSwgZGlzcXVhbGlmaWVkOiBQb3BJdGVtPENvbnRhY3Q+W10gfVxyXG4gZXhwb3J0IHR5cGUgU3RlcENvZGU9c3RyaW5nO1xyXG4gZXhwb3J0IHR5cGUgU3RlcFN0YXR1cz1udW1iZXI7XHJcbiBleHBvcnQgdHlwZSBSZXR1cm5Nb2RlPW51bWJlcjtcclxuIFxyXG4gZXhwb3J0IHR5cGUgUmF3PWFueTtcclxuIGV4cG9ydCB0eXBlIFJhd0hhc2g9e1trZXk6c3RyaW5nXTpSYXd9O1xyXG4gXHJcbiBleHBvcnQgdHlwZSBSYXdHZXRBbGxIYXNoPXttYWluOlJhd0hhc2gscG9wdWxhdGVkOlJhd0hhc2h9O1xyXG4gXHJcbiBleHBvcnQgdHlwZSBMYW5nQ29kZSA9IHN0cmluZztcclxuIGV4cG9ydCB0eXBlIERvbWFpbkRlZmluaXRpb24gPSB7IGRlZmF1bHRMYW5ndWFnZTogTGFuZ0NvZGUgfTtcclxuXHJcbiBleHBvcnQgdHlwZSBNb2RlbFR5cGU9bnVtYmVyO1xyXG4gZXhwb3J0IHR5cGUgVXNlclJpZ2h0PXtfaWQ6YW55LGxldmVsOnN0cmluZ307IFxyXG4gZXhwb3J0IHR5cGUgSW52aXRlZFVzZXJSaWdodD17ZW1haWw6c3RyaW5nLGxldmVsOnN0cmluZ307IFxyXG4gZXhwb3J0IHR5cGUgRGlzY3Vzc2lvblJlbGF0aW9uPXtyZWxhdGVkOk9iamVjdElkLGRvaWQ6T2JqZWN0SWQscmVsYXRpb250eXBlOnN0cmluZ307XHJcbiBleHBvcnQgdHlwZSBPd25lclRhZz17b3duZXJ0eXBlOnN0cmluZyxvd25lcmlkOiBPYmplY3RJZH07XHJcbiAgZXhwb3J0IHR5cGUgT2JqZWN0SWQ9c3RyaW5nO1xyXG4gIGV4cG9ydCB0eXBlIEFzc29jaWF0aXZlQXJyYXk9e1trZXk6c3RyaW5nXTphbnlbXX07XHJcbiAgZXhwb3J0IHR5cGUgRm9ybUZpZWxkcz17W2tleTpzdHJpbmddOmFueX07XHJcbiAgZXhwb3J0IHR5cGUgU3RyaW5nQXNzb2NpYXRpdmVBcnJheT17W2tleTpzdHJpbmddOnN0cmluZ1tdfTtcclxuIGV4cG9ydCB0eXBlIEFjdGlvbkJhckl0ZW1Db2RlPW51bWJlcjtcclxuICBleHBvcnQgdHlwZSBSZXF1ZXN0UXVlcnlPcHRpb25zPXtcclxuICAgICAgcG9wdWxhdGU/OlF1ZXJ5UG9wdWxhdGVPcHRpb24sXHJcbiAgICAgIHNlbGVjdD86UXVlcnlTZWxlY3RPcHRpb24sXHJcbiAgICAgIG1hdGNoPzpRdWVyeVNvcnRPcHRpb24sXHJcbiAgICAgIHNvcnQ/OlF1ZXJ5U29ydE9wdGlvbixcclxuICAgICAgbGltaXQ/OlF1ZXJ5TGltaXRPcHRpb24sXHJcbiAgICAgIHNraXA/OlF1ZXJ5U2tpcE9wdGlvbn07XHJcbiAgXHJcbiAgXHJcbiAgZXhwb3J0IGludGVyZmFjZSBNb2RlbENhbGxiYWNrPFQ+IHsob2JqOlQpOnZvaWQ7fVxyXG4gIGV4cG9ydCBpbnRlcmZhY2UgTW9kZWxBcnJheUNhbGxiYWNrPFQ+IHsob2JqOlRbXSk6dm9pZDt9XHJcblxyXG4iXX0=